
open Ppxlib

let ext_fun ~ctxt opt arr =
  let loc = Expansion_context.Extension.extension_point_loc ctxt in
  Ast_builder.Default.(pexp_construct ~loc opt arr)

let extracter () = Ast_pattern.(single_expr_payload
                                  (pexp_construct __ __))

let exten = Extension.V3.declare
              "mat"
              Extension.Context.Expression
              (extracter ())
              ext_fun

let rule = Context_free.Rule.extension exten

let () = 
  Ppxlib.Driver.register_transformation ~rules:[rule] "mat";
  print_endline "Hello, World!";
  ()
